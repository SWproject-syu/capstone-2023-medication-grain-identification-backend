# Pill-identification

1. 추가 설명
- 이 코드는 FastAPI를 사용하여 구현된 웹 API 서버입니다.
- 서버는 이미지를 입력으로 받아, 해당 이미지 내에 존재하는 물체(약)를 식별하고, 그에 대한 정보를 반환하는 기능을 수행합니다.
- 이 과정에서 YOLOv8, Donut, TinyViT 등 다양한 딥러닝 모델을 활용합니다.

2. 세부 설명:
2-1. 기본 설정 및 모델 로딩:
- 필요한 라이브러리와 모듈을 임포트합니다.
- 이에는 이미지 처리(CV2, PIL), 딥러닝(torch, transformers, ultralytics), 데이터베이스 관련 도구들이 포함됩니다.
- METADATA_PATH는 약에 대한 메타데이터가 저장된 파일 경로입니다.
- 세 가지 딥러닝 모델(YOLOv8, Donut, TinyViT)의 가중치 파일 경로를 지정합니다.
  - device 변수를 통해 모델이 실행될 디바이스(CPU 또는 CUDA)를 설정합니다.
  - 각 모델을 로딩하고 초기화합니다. YOLOv8은 객체 검출, Donut은 OCR(문자 인식), TinyViT은 색상이나 형태와 같은 세부적인 특성 분류에 사용됩니다.
- FastAPI 설정:
  - FastAPI 인스턴스를 생성하고 CORS(Cross-Origin Resource Sharing) 설정을 추가합니다. 이를 통해 다른 출처의 리소스 요청을 허용합니다.
  - 데이터베이스 연결을 위한 설정을 초기화합니다.
- 데이터베이스 설정
  - SQLAlchemy를 사용하여 데이터베이스 엔진과 세션을 설정합니다. 이는 앱이 데이터베이스와 통신하는 데 사용됩니다.
- 이미지 처리 및 예측 함수
  - predict 함수는 입력된 이미지에서 약을 식별하고, 그 정보를 반환하는 주요 기능을 수행합니다.
  - YOLOv8 모델을 사용하여 이미지에서 객체(약)의 위치를 검출합니다.
  - 검출된 객체에 대해 Donut 모델을 사용하여 OCR을 수행하고, 약에 적힌 문자를 인식합니다.
  - TinyViT 모델을 사용하여 검출된 객체의 세부 특성(색상, 형태 등)을 분류합니다.
  - 최종적으로, 형태, 식별된 문자(ID), 색상 정보를 기반으로 약에 대한 정보를 반환합니다.
- API 엔드포인트:
  - /test_return, /test_input, /test_predict, /test_predict_query, /predict_medicine, /predict_medicine_query 등의 엔드포인트를 통해 다양한 API 기능을 제공합니다.
  - 각 엔드포인트는 테스트, 이미지 분석 및 예측, 데이터베이스 쿼리 수행 등의 작업을 수행합니다.
- 실행
  - 마지막으로, uvicorn을 사용하여 FastAPI 앱을 호스팅합니다.
  - 이 코드는 서버를 0.0.0.0 주소와 3636 포트에서 실행시킵니다.

- 이 코드는 현대적인 웹 API 서버를 구축하여, 이미지 내의 물체를 식별하고 분류하는 복잡한 딥러닝 모델들을 활용하는 방법을 보여줍니다. 또한, FastAPI, SQLAlchemy 등의 도구를 사용하여 효율적으로 서버를 개발하고 관리하는 방법을 제시합니다.
